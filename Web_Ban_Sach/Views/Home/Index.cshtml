@model List<Web_Ban_Sach.Models.Book>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutPage1.cshtml";
}

<style>
    .book-thumb-wrapper {
        height: 190px; /* chiều cao khung ảnh */
        background: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden; /* chặn tràn */
        border-radius: 14px 14px 0 0;
    }

    .book-thumb {
        max-width: 100%; /* không vượt quá card */
        max-height: 100%; /* không vượt quá khung */
        object-fit: contain; /* ảnh ngang/dọc đều fit */
        display: block;
    }

</style>
<div class="row g-3">
    @foreach (var item in Model)
    {
        <!-- 4 cuốn / hàng trên màn lớn, 3 cuốn trên md, 2 trên sm -->
        <div class="col-6 col-md-4 col-lg-3">
            <div class="card h-100 book-card">
                <!-- Ảnh bìa: nhỏ lại, hiển thị hết ảnh -->
                <div class="book-thumb-wrapper">
                    <img class="book-thumb"
                         src="@Url.Content(string.IsNullOrEmpty(item.CoverImageUrl)
                     ? "~/Images/anhmacdinh.jpg"
                     : item.CoverImageUrl)"
                         alt="@item.Name" />
                </div>

                <div class="card-body d-flex flex-column">
                    <h6 class="card-title text-truncate mb-1" title="@item.Name">
                        @item.Name
                    </h6>

                    <p class="card-text text-danger fw-bold mb-1">
                        @String.Format("{0:N0} đ", item.Price)
                    </p>

                    @{
                        // Lấy tên tác giả đầu tiên (nếu có)
                        string authorName = "Đang cập nhật";
                        if (item.BookAuthors != null && item.BookAuthors.Any())
                        {
                            var link = item.BookAuthors.FirstOrDefault();
                            if (link != null && link.Author != null)
                            {
                                authorName = link.Author.Name;
                            }
                        }
                    }

                    <p class="card-text text-muted small mb-2">
                        Tác giả: @authorName
                    </p>

                    <a href="@Url.Action("Details", "Home", new { id = item.Id })"
                       class="btn btn-sm btn-outline-primary mt-auto">
                        Xem chi tiết
                    </a>
                </div>
            </div>
        </div>
    }
</div>
